---
title: "Human microbiome example"
output: html_document
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(knitr)
source("knitr_settings.R")
```


### Analyses parameters

```{r}
output_folder <- "human_microbiome_results"
output_format <- ".pdf"
```

### Create output directory

```{r}
dir.create(output_folder, showWarnings = FALSE)
```


### Parsing taxonomic data

The code below downloads a compressed archive and uncompresses it:

```{r}
download_and_extract <- function(url) {
  temp_dir_path <- tempdir()
  local_file_path <- file.path(temp_dir_path, basename(url))
  download.file(url = url, destfile = local_file_path, quiet = TRUE)
  unzipped_path <- R.utils::gunzip(local_file_path, overwrite = TRUE)
  unzipped_path[1]
}
```

```{r, warning=FALSE, message=FALSE}
library(metacoder)
v13_data <- parse_hmp_qiime(otu_file = "http://downloads.hmpdacc.org/data/HMQCP/otu_table_psn_v13.txt.gz",
                            mapping_file = "http://downloads.hmpdacc.org/data/HMQCP/v13_map_uniquebyPSN.txt.bz2")
```
