---
title: "Extracting taxonomy information from sequence metadata"
author: "Zachary Foster"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
%\VignetteIndexEntry{Extracting taxonomy information from sequence headers}
%\VignetteEngine{knitr::rmarkdown}
%\usepackage[utf8]{inputenc}
---


```{r}
library(ape)
library(metacoder)
```




### Genbank FASTA headers

```{r}
sequences <- ape::read.FASTA("inst/extdata/ncbi_basidiomycetes.fasta")
tax_info <- extract_taxonomy(names(sequences),
                             regex = "^.*\\|(.*)\\|.*\\|(.*)\\|.*$",
                             key = c("item_id", other_id = "item_info"),
                             database = "ncbi")
```


### UNITE FATA headers

```{r}
sequences <- ape::read.FASTA("inst/extdata/unite_general_release.fasta")
tax_info <- extract_taxonomy(names(sequences),
                             regex = "^(.*)\\|(.*)\\|(.*)\\|.*\\|(.*)$",
                             key = c("taxon_name", "item_id", sh = "taxon_info", "lineage"),
                             database = "ncbi")
```
